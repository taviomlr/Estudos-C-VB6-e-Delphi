VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "cNotaSaidaDuplicatasIntegra"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Option Explicit

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''
''
''  Implementation of the  Class cNotaSaidaDuplicatasIntegra
''  Generated by Enterprise Architect
''  Created on:      26-set-2014 16:31:55
''  Original author: Vinicius Elyseu
''
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

Private mstrTipoRegistro As String
Private mlngNumeroNota As Long
Private mstrFornecedor As String
Private mintCodigoCfop As Integer
'pt. 83054 - Dulcino Júnior (0904/2008)
Private mstrComplementoCfop As String
Private mintTipoDocumento As enDocumento
Private mlngCodigoTransp As Long
Private mintVariacaoCodigoCfop As Integer
Private mdblQuantidade1 As Double
Private mcurValor As Currency
Private mdblQuantidade2 As Double
Private mcurValorDesconto As Currency
Private mcurValorBaseIcms As Currency
Private mcurValorAliquotaIcms As Currency
Private mcurValorIpi As Currency
Private mcurValorBaseIpi As Currency
Private mcurValorBaseIcmsSubstituicao As Currency
Private mcurValorAliquotaIpi As Currency
Private mcurPorcentagemReducaoIcms As Currency
Private mintSituacaoTributaria As Integer

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Private mdblPISRetido As Double
Private mdblIRRetido As Double
Private mdblCOFINSRetido As Double
Private mdblCSLLRetido As Double
'PT. 105517 - Carlos Felippe Vernizze - 08/06/2011
Private mstrCFOPItem                    As String

Private mstrSituacaoTributariaIPI As String
Private mstrSituacaoTributariaPIS As String
Private mdblValorBasePIS As Double
Private mdblValorAliquotaPIS As Double
Private mdblQuantidadeBasePIS As Double
Private mdblValorAliquotaPIS_RECOB As Double
Private mdblValorPIS As Double
Private mstrSituacaoTributariaCOFINS As String
Private mdblValorBaseCOFINS As Double
Private mdblValorAliquotaCOFINS As Double
Private mdblQuantidadeBaseCOFINS As Double
Private mdblValorAliquotaCOFINS_RECOB As Double
Private mdblValorCOFINS As Double
Private mdblValorICMS_ST As Double
Private mdblValorAliquotaICMS_ST As Double
Private mdblValorICMS As Double
'pt. 000000 - Ivo Sousa (16/11/2011)
Private mstrUnidade As String

'Projeto: #3444 - História: #3468 - Desenvolvimento#3729 - João Henrique(15/01/2013)
Private mblnSituacaoTributariaSimples       As Boolean

'Projeto: #7904 - História: #7887 - Desenvolvimento#8564 - João Henrique(29/05/2013)
Private mcurporcentagemReducaoBaseIcms As Currency

'Projeto: #7904 - História: #7887 - Desenvolvimento#8564 - João Henrique(29/05/2013)
Public Property Let porcentagemReducaoBaseIcms(ByVal NewVal As Currency)
    mcurporcentagemReducaoBaseIcms = NewVal
End Property

'Projeto: #7904 - História: #7887 - Desenvolvimento#8564 - João Henrique(29/05/2013)
Public Property Get porcentagemReducaoBaseIcms() As Currency
    porcentagemReducaoBaseIcms = mcurporcentagemReducaoBaseIcms
End Property


'Projeto: #3444 - História: #3468 - Desenvolvimento#3729 - João Henrique(15/01/2013)
'Campo criado para verificar se a situação tributaria é simples nacional
Public Property Get SituacaoTributariaSimples() As Boolean
    SituacaoTributariaSimples = mblnSituacaoTributariaSimples
End Property

'Projeto: #3444 - História: #3468 - Desenvolvimento#3729 - João Henrique(15/01/2013)
Public Property Let SituacaoTributariaSimples(ByVal NewVal As Boolean)
    mblnSituacaoTributariaSimples = NewVal
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Get PISRetido() As String
    PISRetido = mdblPISRetido
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Let PISRetido(ByVal dblPISRetido As String)
    mdblPISRetido = dblPISRetido
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Get IRRetido() As String
    IRRetido = mdblIRRetido
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Let IRRetido(ByVal dblIRRetido As String)
    mdblIRRetido = dblIRRetido
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Get COFINSRetido() As String
    COFINSRetido = mdblCOFINSRetido
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Let COFINSRetido(ByVal dblCOFINSRetido As String)
    mdblCOFINSRetido = dblCOFINSRetido
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Get CSLLRetido() As String
    CSLLRetido = mdblCSLLRetido
End Property

'Protocolo Nr 103536 - Carlos Felippe Vernizze - 26/01/2011
Public Property Let CSLLRetido(ByVal dblCSLLRetido As String)
    mdblCSLLRetido = dblCSLLRetido
End Property

Public Property Let CodigoProduto(ByVal NewVal As String)
    mstrCodigoProduto = NewVal
End Property

Public Property Get CodigoProduto() As String
    CodigoProduto = mstrCodigoProduto
End Property

Public Property Get Fornecedor() As String
    Fornecedor = mstrFornecedor
End Property

Public Property Let Fornecedor(ByVal NewVal As String)
    mstrFornecedor = NewVal
End Property

Public Property Get codigoCfop() As Integer
    codigoCfop = mintCodigoCfop
End Property

Public Property Let codigoCfop(ByVal NewVal As Integer)
    mintCodigoCfop = NewVal
End Property

Public Property Get variacaoCodigoCfop() As Integer
    variacaoCodigoCfop = mintVariacaoCodigoCfop
End Property

Public Property Let variacaoCodigoCfop(ByVal NewVal As Integer)
    mintVariacaoCodigoCfop = NewVal
End Property

Public Property Get NumeroNota() As Long
    NumeroNota = mlngNumeroNota
End Property

Public Property Let NumeroNota(ByVal NewVal As Long)
    mlngNumeroNota = NewVal
End Property

Public Property Let porcentagemReducaoIcms(ByVal NewVal As Currency)
    mcurPorcentagemReducaoIcms = NewVal
End Property

Public Property Get porcentagemReducaoIcms() As Currency
    porcentagemReducaoIcms = mcurPorcentagemReducaoIcms
End Property

Public Property Let quantidade1(ByVal NewVal As Double)
    mdblQuantidade1 = NewVal
End Property

Public Property Get quantidade1() As Double
    quantidade1 = mdblQuantidade1
End Property

Public Property Let quantidade2(ByVal NewVal As Double)
    mdblQuantidade2 = NewVal
End Property

Public Property Get quantidade2() As Double
    quantidade2 = mdblQuantidade2
End Property

Public Property Get SituacaoTributaria() As Integer
    SituacaoTributaria = mintSituacaoTributaria
End Property

Public Property Let SituacaoTributaria(ByVal NewVal As Integer)
    mintSituacaoTributaria = NewVal
End Property

Public Property Let TipoRegistro(ByVal NewVal As String)
    mstrTipoRegistro = NewVal
End Property

Public Property Get TipoRegistro() As String
    TipoRegistro = mstrTipoRegistro
End Property

Public Property Get valor() As Currency
    valor = mcurValor
End Property

Public Property Let valor(ByVal NewVal As Currency)
    mcurValor = NewVal
End Property

Public Property Get valorAliquotaIcms() As Currency
    valorAliquotaIcms = mcurValorAliquotaIcms
End Property

Public Property Let valorAliquotaIcms(ByVal NewVal As Currency)
    mcurValorAliquotaIcms = NewVal
End Property

Public Property Get valorAliquotaIpi() As Currency
    valorAliquotaIpi = mcurValorAliquotaIpi
End Property

Public Property Let valorAliquotaIpi(ByVal NewVal As Currency)
    mcurValorAliquotaIpi = NewVal
End Property

Public Property Get valorBaseICMS() As Currency
    valorBaseICMS = mcurValorBaseIcms
End Property

Public Property Let valorBaseICMS(ByVal NewVal As Currency)
    mcurValorBaseIcms = NewVal
End Property

Public Property Get valorBaseIcmsSubstituicao() As Currency
    valorBaseIcmsSubstituicao = mcurValorBaseIcmsSubstituicao
End Property

Public Property Let valorBaseIcmsSubstituicao(ByVal NewVal As Currency)
    mcurValorBaseIcmsSubstituicao = NewVal
End Property

Public Property Let ValorDesconto(ByVal NewVal As Currency)
    mcurValorDesconto = NewVal
End Property

Public Property Get ValorDesconto() As Currency
    ValorDesconto = mcurValorDesconto
End Property

Public Property Get ValorIpi() As Currency
    ValorIpi = mcurValorIpi
End Property

Public Property Let ValorIpi(ByVal NewVal As Currency)
    mcurValorIpi = NewVal
End Property

Public Property Get TipoDocumento() As enDocumento
    TipoDocumento = mintTipoDocumento
End Property

Public Property Let TipoDocumento(ByVal NewVal As enDocumento)
    mintTipoDocumento = NewVal
End Property

Public Property Get codigoTransp() As Long
    codigoTransp = mlngCodigoTransp
End Property

Public Property Let codigoTransp(ByVal NewVal As Long)
    mlngCodigoTransp = NewVal
End Property

Public Property Get valorBaseIpi() As Currency
    valorBaseIpi = mcurValorBaseIpi
End Property

Public Property Let valorBaseIpi(ByVal NewVal As Currency)
    mcurValorBaseIpi = NewVal
End Property

Public Property Get ComplementoNatureza() As String
    ComplementoNatureza = mstrComplementoCfop
End Property

Public Property Let ComplementoNatureza(ByVal NewVal As String)
    mstrComplementoCfop = NewVal
End Property

'PT. 105517 - Carlos Felippe Vernizze - 08/06/2011
Public Property Get CFOPItem() As String
    CFOPItem = mstrCFOPItem
End Property

'PT. 105517 - Carlos Felippe Vernizze - 08/06/2011
Public Property Let CFOPItem(ByVal strCFOPItem As String)
    mstrCFOPItem = strCFOPItem
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get SituacaoTributariaIPI() As String
    SituacaoTributariaIPI = mstrSituacaoTributariaIPI
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let SituacaoTributariaIPI(ByVal strSituacaoTributariaIPI As String)
    mstrSituacaoTributariaIPI = strSituacaoTributariaIPI
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get SituacaoTributariaPIS() As String
    SituacaoTributariaPIS = mstrSituacaoTributariaPIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let SituacaoTributariaPIS(ByVal strSituacaoTributariaPIS As String)
    mstrSituacaoTributariaPIS = strSituacaoTributariaPIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorBasePIS() As Double
    ValorBasePIS = mdblValorBasePIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorBasePIS(ByVal dblValorBasePIS As Double)
    mdblValorBasePIS = dblValorBasePIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorAliquotaPIS() As Double
    ValorAliquotaPIS = mdblValorAliquotaPIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorAliquotaPIS(ByVal dblValorAliquotaPIS As Double)
    mdblValorAliquotaPIS = dblValorAliquotaPIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get QuantidadeBasePIS() As Double
    QuantidadeBasePIS = mdblQuantidadeBasePIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let QuantidadeBasePIS(ByVal dblQuantidadeBasePIS As Double)
    mdblQuantidadeBasePIS = dblQuantidadeBasePIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorAliquotaPIS_RECOB() As Double
    ValorAliquotaPIS_RECOB = mdblValorAliquotaPIS_RECOB
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorAliquotaPIS_RECOB(ByVal dblValorAliquotaPIS_RECOB As Double)
    mdblValorAliquotaPIS_RECOB = dblValorAliquotaPIS_RECOB
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorPIS() As Double
    ValorPIS = mdblValorPIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorPIS(ByVal dblValorPIS As Double)
    mdblValorPIS = dblValorPIS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get SituacaoTributariaCOFINS() As String
    SituacaoTributariaCOFINS = mstrSituacaoTributariaCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let SituacaoTributariaCOFINS(ByVal strSituacaoTributariaCOFINS As String)
    mstrSituacaoTributariaCOFINS = strSituacaoTributariaCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorBaseCOFINS() As Double
    ValorBaseCOFINS = mdblValorBaseCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorBaseCOFINS(ByVal dblValorBaseCOFINS As Double)
    mdblValorBaseCOFINS = dblValorBaseCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorAliquotaCOFINS() As Double
    ValorAliquotaCOFINS = mdblValorAliquotaCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorAliquotaCOFINS(ByVal dblValorAliquotaCOFINS As Double)
    mdblValorAliquotaCOFINS = dblValorAliquotaCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get QuantidadeBaseCOFINS() As Double
    QuantidadeBaseCOFINS = mdblQuantidadeBaseCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let QuantidadeBaseCOFINS(ByVal dblQuantidadeBaseCOFINS As Double)
    mdblQuantidadeBaseCOFINS = dblQuantidadeBaseCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorAliquotaCOFINS_RECOB() As Double
    ValorAliquotaCOFINS_RECOB = mdblValorAliquotaCOFINS_RECOB
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorAliquotaCOFINS_RECOB(ByVal dblValorAliquotaCOFINS_RECOB As Double)
    mdblValorAliquotaCOFINS_RECOB = dblValorAliquotaCOFINS_RECOB
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorCOFINS() As Double
    ValorCOFINS = mdblValorCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorCOFINS(ByVal dblValorCOFINS As Double)
    mdblValorCOFINS = dblValorCOFINS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorICMS_ST() As Double
    ValorICMS_ST = mdblValorICMS_ST
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorICMS_ST(ByVal dblValorICMS_ST As Double)
    mdblValorICMS_ST = dblValorICMS_ST
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorAliquotaICMS_ST() As Double
    ValorAliquotaICMS_ST = mdblValorAliquotaICMS_ST
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorAliquotaICMS_ST(ByVal dblValorAliquotaICMS_ST As Double)
    mdblValorAliquotaICMS_ST = dblValorAliquotaICMS_ST
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Get ValorICMS() As Double
    ValorICMS = mdblValorICMS
End Property

'PT. 105517 - Carlos Felippe Vernizze - 09/06/2011
Public Property Let ValorICMS(ByVal dblValorICMS As Double)
    mdblValorICMS = dblValorICMS
End Property

'pt. 000000 - Ivo Sousa (16/11/2011)
Public Property Get Unidade() As String
    Unidade = mstrUnidade
End Property

Public Property Let Unidade(ByVal strUnidade As String)
    mstrUnidade = strUnidade
End Property

'Descrição..: Metodo utilizado para criar um objeto do tipo item de nota de saída.
'Parametros.: [IDBReader] Reader posicionado no registro do qual serão extraidas as
'                informações.
'Retorno....: [cNotaSaidaItensIntegra] Objetode Item de nota de Saída Criado.
Public Function CriarObjeto(ByVal rd As IDBReader) As cNotaSaidaItensIntegra
    With rd
        mstrCodigoProduto = .GetString("cd_produto")
        mstrTipoRegistro = .GetString("tp_registro")
        mlngNumeroNota = .GetLong("nr_nota")
        mstrFornecedor = .GetString("fornecedor")
        mintCodigoCfop = .GetInteger("cd_cfop")
        mintTipoDocumento = .GetInteger("tp_documento")
        mlngCodigoTransp = .GetLong("cd_codigo")
        mintVariacaoCodigoCfop = .GetInteger("cd_cfop_variacao")
        mdblQuantidade1 = .GetDouble("qt_quantidade1")
        mdblQuantidade2 = .GetDouble("qt_quantidade2")
        mcurValor = .GetCurrency("vl_valor")
        mcurValorDesconto = .GetCurrency("vl_desconto")
        mcurValorBaseIcms = .GetCurrency("vl_base_icms")
        mcurValorAliquotaIcms = .GetCurrency("vl_aliquota_icms")
        mcurValorIpi = .GetCurrency("vl_valor_ipi")
        mcurValorBaseIpi = .GetCurrency("vl_base_ipi")
        mcurValorBaseIcmsSubstituicao = .GetCurrency("vl_base_icms_st")
        mcurValorAliquotaIpi = .GetCurrency("vl_aliquota_ipi")
        
        'Projeto: #8404 - História: #8384 - Problema#9380 - João Henrique(28/06/2013)
        'mcurPorcentagemReducaoIcms = .GetCurrency("pr_reducao_icms")
        mcurporcentagemReducaoBaseIcms = .GetCurrency("pr_reducao_Base_icms")
        mintSituacaoTributaria = .GetInteger("sit_tributaria")
        'PT. 105517 - Carlos Felippe Vernizze - 08/06/2011
        mstrCFOPItem = .GetString("CFOP_Item")
        mstrSituacaoTributariaIPI = .GetString("SituacaoTributariaIPI")
        mstrSituacaoTributariaPIS = .GetString("SituacaoTributariaPIS")
        mdblValorBasePIS = .GetDouble("ValorBasePIS")
        mdblValorAliquotaPIS = .GetDouble("ValorAliquotaPIS")
        mdblQuantidadeBasePIS = .GetDouble("QuantidadeBasePIS")
        mdblValorAliquotaPIS_RECOB = .GetDouble("ValorAliquotaPIS_RECOB")
        mdblValorPIS = .GetDouble("ValorPIS")
        mstrSituacaoTributariaCOFINS = .GetString("SituacaoTributariaCOFINS")
        mdblValorBaseCOFINS = .GetDouble("ValorBaseCOFINS")
        mdblValorAliquotaCOFINS = .GetDouble("ValorAliquotaCOFINS")
        mdblQuantidadeBaseCOFINS = .GetDouble("QuantidadeBaseCOFINS")
        mdblValorAliquotaCOFINS_RECOB = .GetDouble("ValorAliquotaCOFINS_RECOB")
        mdblValorCOFINS = .GetDouble("ValorCOFINS")
        mdblValorICMS_ST = .GetDouble("ValorICMS_ST")
        mdblValorAliquotaICMS_ST = .GetDouble("ValorAliquotaICMS_ST")
        mdblValorICMS = .GetDouble("ValorICMS")
        'pt. 000000 - Ivo Sousa (16/11/2011)
        mstrUnidade = .GetString("unidade")
        
        'Projeto: #3444 - História: #3468 - Desenvolvimento#3729 - João Henrique(15/01/2013)
        mblnSituacaoTributariaSimples = .GetBoolean("SimplesNacional")
        
    End With
    Set CriarObjeto = Me
End Function

'Descrição..: Metodo responsável por verificar se o NCM do produto deste item é valido.
'Retorno....: [Boolean] retorna True se for válido.
Public Function ncmValido(objFoxApp As IApplication) As Boolean
Dim Produto As cProduto
Dim daoFactory As New cDAOFactory
    Set Produto = daoFactory.criarProdutoDAO(objFoxApp).Carregar(Me.CodigoProduto)
    If Produto.Ncm = 0 Then
        ncmValido = False
    Else
        ncmValido = True
    End If
End Function

'Descrição..: Metodo utilizado para verificar se o objeto informado é igual o atual.
'Parametros.: [Object] Objeto a ser comparado com o objeto atual.
'Retorno....: [Boolean] Se os objetos são iguais.
Public Function Equals(ByVal obj As Object) As Boolean
    Dim item As cNotaSaidaItensIntegra
    
    If TypeName(obj) <> TypeName(Me) Then
        Equals = False
        Exit Function
    Else
        Set item = obj
    End If
    Equals = True
    Equals = Equals And (Me.TipoRegistro = item.TipoRegistro)
    Equals = Equals And (Me.NumeroNota = item.NumeroNota)
    Equals = Equals And (Me.Fornecedor = item.Fornecedor)
    Equals = Equals And (Me.CodigoProduto = item.CodigoProduto)
    Equals = Equals And (Me.codigoCfop = item.codigoCfop)
    Equals = Equals And (Me.TipoDocumento = item.TipoDocumento)
    Equals = Equals And (Me.codigoTransp = item.codigoTransp)
    Set item = Nothing
End Function

